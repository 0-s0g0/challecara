# CHALLECARAã¸ã®OpenAPIå°å…¥ - å®Ÿè£…ã‚µãƒãƒªãƒ¼

## ğŸ‰ å®Ÿè£…å®Œäº†äº‹é …

### 1. ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« âœ…

ä»¥ä¸‹ã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’è¿½åŠ ã—ã¾ã—ãŸï¼š

```json
{
  "devDependencies": {
    "next-swagger-doc": "^0.4.1",
    "swagger-ui-react": "^5.30.3",
    "@types/swagger-ui-react": "^5.18.0",
    "tsx": "^4.x"
  }
}
```

### 2. OpenAPIã‚¹ã‚­ãƒ¼ãƒå®šç¾© âœ…

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/lib/swagger.ts`

- OpenAPI 3.0ä»•æ§˜
- å…¨ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®ã‚¹ã‚­ãƒ¼ãƒå®šç¾©ï¼ˆUser, SocialLink, BlogPostï¼‰
- ã‚¨ãƒ©ãƒ¼ãƒ¬ã‚¹ãƒãƒ³ã‚¹ã®çµ±ä¸€ã‚¹ã‚­ãƒ¼ãƒ
- Bearerèªè¨¼ã‚¹ã‚­ãƒ¼ãƒ ã®å®šç¾©

### 3. APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ä½œæˆ âœ…

ä»¥ä¸‹ã®RESTful APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’å®Ÿè£…ï¼š

#### Users API
- `GET /api/users` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§
- `POST /api/users` - ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
- `GET /api/users/[id]` - ãƒ¦ãƒ¼ã‚¶ãƒ¼è©³ç´°
- `PUT /api/users/[id]` - ãƒ¦ãƒ¼ã‚¶ãƒ¼æ›´æ–°
- `DELETE /api/users/[id]` - ãƒ¦ãƒ¼ã‚¶ãƒ¼å‰Šé™¤

#### Social Links API
- `GET /api/social-links` - ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒªãƒ³ã‚¯ä¸€è¦§ï¼ˆuserIdã§ãƒ•ã‚£ãƒ«ã‚¿å¯èƒ½ï¼‰
- `POST /api/social-links` - ã‚½ãƒ¼ã‚·ãƒ£ãƒ«ãƒªãƒ³ã‚¯ä½œæˆ

#### Blog Posts API
- `GET /api/blog-posts` - ãƒ–ãƒ­ã‚°æŠ•ç¨¿ä¸€è¦§ï¼ˆuserId, isPublishedã§ãƒ•ã‚£ãƒ«ã‚¿å¯èƒ½ï¼‰
- `POST /api/blog-posts` - ãƒ–ãƒ­ã‚°æŠ•ç¨¿ä½œæˆ

å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ã¯ï¼š
- JSDocã«ã‚ˆã‚‹Swaggerä»•æ§˜è¨˜è¿°
- é©åˆ‡ãªHTTPã‚¹ãƒ†ãƒ¼ã‚¿ã‚¹ã‚³ãƒ¼ãƒ‰
- ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°
- ã‚¹ã‚­ãƒ¼ãƒå‚ç…§ï¼ˆ$refï¼‰

### 4. Swagger UIãƒšãƒ¼ã‚¸ âœ…

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app/api/docs/page.tsx`

- http://localhost:3000/api/docs ã§ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½
- å¯¾è©±çš„ãªAPIãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ
- Try it outæ©Ÿèƒ½ã§APIã‚’ç›´æ¥ãƒ†ã‚¹ãƒˆå¯èƒ½

### 5. OpenAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆ âœ…

**ãƒ•ã‚¡ã‚¤ãƒ«**: `src/app/api/openapi/route.ts`

- http://localhost:3000/api/openapi ã§JSONä»•æ§˜ã‚’å–å¾—
- å‹•çš„ç”Ÿæˆã«ã‚ˆã‚‹ãƒªã‚¢ãƒ«ã‚¿ã‚¤ãƒ æ›´æ–°

### 6. ã‚¹ã‚­ãƒ¼ãƒç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆ âœ…

**ãƒ•ã‚¡ã‚¤ãƒ«**: `scripts/generate-openapi.ts`

å®Ÿè¡Œæ–¹æ³•ï¼š
```bash
npm run openapi:generate
```

æ©Ÿèƒ½ï¼š
- OpenAPIä»•æ§˜ã‚’JSONãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦ `public/openapi.json` ã«å‡ºåŠ›
- ãƒ“ãƒ«ãƒ‰å‰ã«è‡ªå‹•å®Ÿè¡Œï¼ˆprebuildãƒ•ãƒƒã‚¯ï¼‰

### 7. npmã‚¹ã‚¯ãƒªãƒ—ãƒˆã®è¨­å®š âœ…

**package.json** ã«ä»¥ä¸‹ã‚’è¿½åŠ ï¼š

```json
{
  "scripts": {
    "openapi:generate": "tsx scripts/generate-openapi.ts",
    "prebuild": "npm run openapi:generate"
  }
}
```

### 8. ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆ âœ…

- `docs/API_SETUP.md` - è©³ç´°ãªã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—ã‚¬ã‚¤ãƒ‰
- `API_QUICKSTART.md` - ã‚¯ã‚¤ãƒƒã‚¯ã‚¹ã‚¿ãƒ¼ãƒˆã‚¬ã‚¤ãƒ‰

## ğŸ”„ ãƒãƒƒã‚¯ã‚¨ãƒ³ãƒ‰ã§ã®ã‚¹ã‚­ãƒ¼ãƒæ›´æ–°ãƒ•ãƒ­ãƒ¼

### æ–¹æ³•1: æ–°ã—ã„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã‚’è¿½åŠ 

1. Route Handlerãƒ•ã‚¡ã‚¤ãƒ«ã‚’ä½œæˆ
   ```typescript
   // src/app/api/new-endpoint/route.ts
   /**
    * @swagger
    * /api/new-endpoint:
    *   get:
    *     summary: New endpoint
    */
   export async function GET() { ... }
   ```

2. å¿…è¦ã«å¿œã˜ã¦ã‚¹ã‚­ãƒ¼ãƒã‚’å®šç¾©
   ```typescript
   // src/lib/swagger.ts ã® components.schemas ã«è¿½åŠ 
   ```

3. ã‚¹ã‚­ãƒ¼ãƒã‚’å†ç”Ÿæˆ
   ```bash
   npm run openapi:generate
   ```

### æ–¹æ³•2: æ—¢å­˜ã®ã‚¹ã‚­ãƒ¼ãƒã‚’æ›´æ–°

1. `src/lib/swagger.ts` ã‚’ç·¨é›†

2. ã‚¹ã‚­ãƒ¼ãƒã‚’å†ç”Ÿæˆ
   ```bash
   npm run openapi:generate
   ```

### è‡ªå‹•æ›´æ–°

ãƒ“ãƒ«ãƒ‰æ™‚ã«è‡ªå‹•çš„ã«ã‚¹ã‚­ãƒ¼ãƒãŒæ›´æ–°ã•ã‚Œã¾ã™ï¼š
```bash
npm run build  # prebuildãƒ•ãƒƒã‚¯ã§è‡ªå‹•ç”Ÿæˆ
```

## ğŸ“Š ç”Ÿæˆã•ã‚ŒãŸãƒ•ã‚¡ã‚¤ãƒ«

- `public/openapi.json` (19KB) - OpenAPIä»•æ§˜ï¼ˆé™çš„ãƒ•ã‚¡ã‚¤ãƒ«ï¼‰

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### é–‹ç™ºã‚µãƒ¼ãƒãƒ¼ã§ç¢ºèª

```bash
npm run dev
```

ãƒ–ãƒ©ã‚¦ã‚¶ã§ http://localhost:3000/api/docs ã«ã‚¢ã‚¯ã‚»ã‚¹

### APIã®ãƒ†ã‚¹ãƒˆ

```bash
# ãƒ¦ãƒ¼ã‚¶ãƒ¼ä¸€è¦§
curl http://localhost:3000/api/users

# ãƒ¦ãƒ¼ã‚¶ãƒ¼ä½œæˆ
curl -X POST http://localhost:3000/api/users \
  -H "Content-Type: application/json" \
  -d '{"accountId":"test","password":"12345678","nickname":"Test","bio":"Bio","avatarUrl":"https://example.com/img.jpg"}'
```

## ğŸ“‹ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—ï¼ˆTODOï¼‰

å„APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã«ã¯ `TODO` ã‚³ãƒ¡ãƒ³ãƒˆãŒå«ã¾ã‚Œã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã®çµ±åˆä½œæ¥­ãŒå¿…è¦ã§ã™ï¼š

### 1. Use Caseã¨ã®çµ±åˆ

ç¾åœ¨ã€å„ã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¯ãƒ¢ãƒƒã‚¯ãƒ‡ãƒ¼ã‚¿ã‚’è¿”ã—ã¦ã„ã¾ã™ã€‚ä»¥ä¸‹ã®Use Caseã¨çµ±åˆãŒå¿…è¦ï¼š

- `src/app/domain/usecase/profileCreationUseCase.ts`
- `src/app/domain/usecase/getProfileUseCase.ts`
- `src/app/domain/usecase/authLoginUseCase.ts`

ä¾‹ï¼š
```typescript
// Before (mock)
const users = [{ id: '1', ... }];

// After (use case integration)
import { GetProfileUseCase } from '@/app/domain/usecase/getProfileUseCase';
const useCase = useCaseFactory.createGetProfileUseCase();
const users = await useCase.execute();
```

### 2. èªè¨¼ã®å®Ÿè£…

- JWTèªè¨¼ã®è¿½åŠ 
- `bearerAuth` ã‚¹ã‚­ãƒ¼ãƒ ã®é©ç”¨
- ä¿è­·ã•ã‚ŒãŸã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã¸ã®ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢è¿½åŠ 

### 3. ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ã®å¼·åŒ–

- Zodã‚¹ã‚­ãƒ¼ãƒã«ã‚ˆã‚‹å…¥åŠ›ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³
- ãƒ‰ãƒ¡ã‚¤ãƒ³ãƒ¢ãƒ‡ãƒ«ã®ãƒãƒªãƒ‡ãƒ¼ã‚·ãƒ§ãƒ³ãƒ«ãƒ¼ãƒ«ã¨ã®é€£æº

### 4. ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹çµ±åˆ

- Repositoryå±¤ã®å®Ÿè£…
- Prismaã¨ã®çµ±åˆ

### 5. ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æ”¹å–„

- ã‚«ã‚¹ã‚¿ãƒ ã‚¨ãƒ©ãƒ¼ã‚¯ãƒ©ã‚¹ã®ä½œæˆ
- ã‚ˆã‚Šè©³ç´°ãªã‚¨ãƒ©ãƒ¼ã‚³ãƒ¼ãƒ‰ã¨ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸

## ğŸ” ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£è€ƒæ…®äº‹é …

ç¾åœ¨ã®å®Ÿè£…ã«ã¯ä»¥ä¸‹ã®åˆ¶é™ãŒã‚ã‚Šã¾ã™ï¼š

- âš ï¸ èªè¨¼ãƒ»èªå¯ãŒæœªå®Ÿè£…
- âš ï¸ ãƒ¬ãƒ¼ãƒˆåˆ¶é™ãŒæœªå®Ÿè£…
- âš ï¸ CORSã®è¨­å®šãŒæœªè¨­å®š
- âš ï¸ ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã®ãƒãƒƒã‚·ãƒ¥åŒ–ãŒæœªå®Ÿè£…

æœ¬ç•ªç’°å¢ƒã¸ã®ãƒ‡ãƒ—ãƒ­ã‚¤å‰ã«ã€ã“ã‚Œã‚‰ã®ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£å¯¾ç­–ã‚’å®Ÿè£…ã—ã¦ãã ã•ã„ã€‚

## ğŸ¯ ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã®çµ±åˆ

CHALLECARAã®ã‚¯ãƒªãƒ¼ãƒ³ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£ã¨ã®å¯¾å¿œï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 9. Appå±¤ (Next.js App Router)          â”‚
â”‚   â””â”€â”€ app/api/**/route.ts              â”‚ â† æ–°è¦è¿½åŠ ï¼ˆOpenAPIå¯¾å¿œï¼‰
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 5. Controllerå±¤                         â”‚
â”‚   â””â”€â”€ src/app/interface/controller/     â”‚ â† ä»Šå¾Œçµ±åˆäºˆå®š
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
           â†“
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ 2. Usecaseå±¤                            â”‚
â”‚   â””â”€â”€ src/app/domain/usecase/           â”‚ â† ä»Šå¾Œçµ±åˆäºˆå®š
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## ğŸ“ å¤‰æ›´ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§

### æ–°è¦ä½œæˆ
- `src/lib/swagger.ts`
- `src/app/api/openapi/route.ts`
- `src/app/api/docs/page.tsx`
- `src/app/api/users/route.ts`
- `src/app/api/users/[id]/route.ts`
- `src/app/api/social-links/route.ts`
- `src/app/api/blog-posts/route.ts`
- `scripts/generate-openapi.ts`
- `docs/API_SETUP.md`
- `API_QUICKSTART.md`
- `public/openapi.json` (ç”Ÿæˆãƒ•ã‚¡ã‚¤ãƒ«)

### å¤‰æ›´
- `package.json` - scriptsè¿½åŠ ã€ä¾å­˜é–¢ä¿‚è¿½åŠ 

## âœ… æ¤œè¨¼æ¸ˆã¿é …ç›®

- [x] ä¾å­˜é–¢ä¿‚ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [x] OpenAPIä»•æ§˜ã®å®šç¾©
- [x] Swagger UIã®å‹•ä½œ
- [x] OpenAPIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®å‹•ä½œ
- [x] ã‚¹ã‚­ãƒ¼ãƒç”Ÿæˆã‚¹ã‚¯ãƒªãƒ—ãƒˆã®å‹•ä½œ
- [x] ãƒ“ãƒ«ãƒ‰æ™‚ã®è‡ªå‹•ç”Ÿæˆï¼ˆprebuildãƒ•ãƒƒã‚¯ï¼‰
- [x] å…¨APIã‚¨ãƒ³ãƒ‰ãƒã‚¤ãƒ³ãƒˆã®ãƒ¢ãƒƒã‚¯å®Ÿè£…
- [x] ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ä½œæˆ

---

**å°å…¥å®Œäº†æ—¥**: 2025-12-07
**å°å…¥è€…**: Claude (AI Assistant)
**OpenAPIãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 3.0.0
**Next.jsãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 16.0.7
